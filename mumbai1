updated code from singapore git
